# tcpdump
TCP 패킷을 캡처할 수 있는 명령어 (https://www.tcpdump.org/manpages/tcpdump.1.html)

```bash
# 캡처할 수 있는 네트워크 인터페이스 목록 출력
tcpdump -D
```

```bash
# source IP, destination IP, port 지정하기
tcpdump -i lo0 src 1.2.3.4 and dst 4.3.2.1 and port 80
```

```bash
# 파일로 저장하기(binary 형식으로 저장됨)
# -w 와 -r의 차이는 뭐지..?
tcpdump -w dump.log -i en0
tcpdump -r dump.log -i en0
```

```bash
# 옵션들
-A: 패킷의 내용을 화면에 ASCII로 출력
-B: 운영체제가 캡처하는 버퍼 크기를 buffer_size로 바꾼다.
-c: 주어진 수의 패킷을 받은 후 종료한다.
-C: 방금 받은 패킷을 저장파일로 만들기 전에 파일이 file_size보다 큰지 체크한다. 만약 그렇다면, 현재 저장파일을 닫고 새로 하나를 연다. 저장된 파일의 이름은 -w 기호를 이용해 1부터 시작해 하나씩 늘어난다.(1,048,576 바이트가 1,000,000바이트)
-d: 컴파일된 packet-matching code를 사람이 읽을 수 있는 표준형으로 바꾼후 멈춘다.
-dd: packet-matching 코드를 C 프로그램의 일부로 표현한다.
-ddd: packet-matching 코드를 십진수로 표현한다.
-D: tcpdump가 패킷을 잡을 수 있는 시스템 상에 가능한 네트워크 인터페이스 목록을 출력한다. 각각의 네트워크 인터페이스에는 번호와 인터페이스 이름이 매겨져 있어야 하고 그에 해당하는 설명이 덧붙여져 있어야 한다. 이 기능은 tcpdump가 오래된 버전일 경우에 지원되지 않을수 있다.
-e: 링크 레벨 헤더를 각각 덤프라인에 출력한다.
-f: 외부 IPv4 주소를 되도록 심볼(상징적)이 아닌 숫자로서 표현한다.
-F: 파일을 필터식(filter expression)으로 입력한다. 추가적으로 명령창에 입력된 식은 무시된다.
-G: 이 옵션을 지정하면 덤프 파일을 -w 옵션으로 매 초마다 회전해 회전된 덤프파일을 저장한다. 저장된 파일은 -w 옵션으로 strftime으로 시간 정보가 정의 되어 이름에 포함되어야 한다. 만약 시간 형식이 저장되지 않으면 매번 새로운 파일은 원래 있던 파일에 덮어 씌워 진다. 만약 -C 옵션과 함께 쓰인다면 이름은 'file<count>'형식으로 저장된다.
-i: 인터페이스를 정한다. 정해지지 않았으면 tcpdump는 시스템 인터페이스 목록에서 가장 낮은 숫자를 고른다.
-I: 인터페이스를 "monitor mode"로 놓는다. 이는 IEEE 802.11 와이파이 인터페이스에서만 작동되고 몇몇 OS에서만 지원된다.
```
